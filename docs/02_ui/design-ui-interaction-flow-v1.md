# MVP UI 使用者操作與交互流程設計

基於最新的 UI 設計，以下是架構清晰的 MVP 階段單用戶核心操作流程：

## 1. 任務管理 (Task Management)

### 1.1 建立新任務流程

- **點擊 [+ 新任務]**
  - 系統開啟 Prompt Input Modal
  - 使用者輸入任務需求描述
  - 點擊確認按鈕
    - 系統在後端創建新任務與初始聊天檔案
    - 系統在 Explorer 中新增該任務條目並自動展開
    - 任務自動標記為進行中狀態 (🏃)
    - 系統顯示已規劃的子任務資料夾結構
    - 系統開啟初始聊天檔案（依照 3.2 開啟聊天流程）

### 1.2 任務狀態管理流程

- **切換任務狀態**
  - 鼠標懸停在任務上，顯示選項按鈕(⋮)
  - 點擊選項按鈕，顯示下拉選單
  - 選擇狀態選項
    - 選擇暫停(⏸️)：系統暫停任務自動進行
    - 選擇繼續(🏃)：系統恢復任務自動進行
    - 選擇完成(✓)：系統標記任務為已完成

### 1.3 任務導航流程

- **展開/折疊任務**
  - 點擊任務前的 ▼/► 圖標
    - ▼ 變為 ►：折疊子任務顯示
    - ► 變為 ▼：展開子任務顯示
- **選擇任務**
  - 點擊任務名稱
    - 系統將焦點切換到該任務
    - 系統自動展開該任務的子任務列表
    - 系統自動選擇第一個進行中的子任務

## 2. 子任務管理 (Subtask Management)

### 2.1 子任務導航流程

- **選擇子任務**
  - 點擊子任務名稱
    - 系統在 Explorer 中高亮顯示該子任務
    - 系統更新頂部導航欄顯示當前路徑
    - 若子任務有聊天檔案，自動開啟最新的聊天檔案（依照 3.2 開啟聊天流程）

### 2.2 子任務狀態管理流程

- **手動觸發子任務**
  - 點擊子任務狀態圖標(▶️)
    - 系統將子任務狀態更改為進行中(🏃)
    - 系統開啟新聊天（依照 3.1 建立新聊天流程）
- **查看子任務選項**
  - 鼠標懸停在子任務上，顯示選項按鈕(⋮)
  - 點擊選項按鈕，顯示下拉選單
    - 選擇觀看詳情：系統開啟子任務詳情面板
    - 選擇略過：系統將子任務標記為已略過，並進入下一個子任務

### 2.3 子任務完成流程

- **批准子任務成果**
  - 在聊天中發送特定確認訊息（如「同意」、「批准」等）
    - 系統識別確認訊息
    - 系統將該子任務狀態更新為完成(✓)
    - 系統自動切換到下一個子任務
    - 系統為下一個子任務建立新聊天（依照 3.1 建立新聊天流程）

## 3. 聊天管理 (Chat Management)

### 3.1 建立新聊天流程

- **點擊子任務下的 [+ 新聊天]**
  - 系統在後端創建新聊天檔案，生成時間戳記格式的檔案名稱
  - 系統在 Explorer 中新增聊天檔案項目(💬)並高亮
  - 系統開啟空白聊天介面
  - 系統自動將輸入焦點設置在聊天輸入框
  - 系統根據子任務類型自動生成初始提示詞（可選）

### 3.2 開啟聊天流程

- **點擊 Explorer 中的聊天檔案項目(💬)**
  - 系統讀取聊天檔案內容
  - 系統在中間區域顯示該聊天歷史記錄
  - 系統自動滾動到最新消息位置
  - 系統更新頂部導航欄顯示當前路徑

### 3.3 聊天互動流程

- **發送文字訊息**

  - 使用者在輸入框輸入文字
  - 點擊 [發送 ➤] 按鈕或按下 Enter 鍵
    - 系統將訊息顯示在聊天區域，標記為 [User]
    - 系統發送訊息到後端處理
    - 系統顯示 AI 回應中狀態
    - AI 回應後，系統將回應顯示在聊天區域，標記為 [AI]
    - 系統自動滾動到最新消息位置
    - 系統儲存聊天記錄到檔案

- **附加檔案到訊息**
  - 點擊 [📎附件] 按鈕
    - 系統開啟檔案選擇器
    - 使用者選擇檔案並確認
  - 或直接拖拽檔案到輸入區域
    - 系統顯示檔案預覽
  - 點擊 [發送 ➤] 按鈕
    - 系統將檔案與訊息一起上傳
    - 系統在聊天區域顯示訊息與附加檔案
    - 後續流程同發送文字訊息

## 4. 檔案管理 (File Management)

### 4.1 檔案瀏覽流程

- **點擊 Explorer 中的檔案項目(📄)**
  - 系統讀取檔案內容
  - MVP 版本：在中間區域顯示檔案內容
  - 系統更新頂部導航欄顯示當前檔案路徑

### 4.2 檔案操作流程

- **檔案操作**
  - 鼠標懸停在檔案上，顯示選項按鈕(⋮)
  - 點擊選項按鈕，顯示下拉選單
    - 選擇編輯：系統進入檔案編輯模式
    - 選擇下載：系統將檔案下載至使用者本地設備
    - 選擇刪除：系統提示確認後刪除檔案
  - 檔案預覽區域的操作按鈕
    - 點擊 [✏️ Edit]：進入檔案編輯模式
    - 點擊 [⬇️ Download]：下載檔案至本地
    - 點擊 [📤 Share]：開啟分享選項

### 4.3 檔案與聊天整合流程

- **在聊天中引用檔案**
  - 使用者在聊天中提及檔案名稱或路徑
    - AI 自動讀取並分析該檔案內容
    - AI 在回應中可以引用檔案內容
  - 使用者請求 AI 針對檔案內容進行修改建議
    - AI 生成修改建議
    - 使用者可以批准建議，系統自動更新檔案

## 5. UI 互動流程

### 5.1 導航流程

- **使用頂部路徑導航**
  - 點擊頂部導航欄的路徑節點（例如: 🏠 Home > 👥 Workspace）
    - 系統導航到對應層級
    - 系統在 Explorer 中高亮對應層級
    - 系統根據選擇的層級顯示相關內容

### 5.2 面板操作

- **MVP 版本面板操作**
  - 拖動中間分隔線
    - 系統調整 Explorer 面板與 Chat/Preview 面板的寬度比例
    - 面板內容根據新寬度自動調整顯示

### 5.3 狀態指示

- **任務狀態視覺指示**
  - 系統通過圖標顯示狀態：
    - 任務/子任務進行中(🏃)
    - 任務/子任務已完成(✓)
    - 任務暫停(⏸️)
    - 子任務待處理(📝)
    - 子任務警告(⚠️)
    - 子任務檢查中(🔍)
    - 子任務出錯(🔴)
